name: Build all Docker images
on:
  schedule:
    - cron: '0 0 * * 4' # Every Thursday at midnight UTC
  repository_dispatch:
  workflow_dispatch:

env:
  FORCE_COLOR: 1

concurrency:
  group: release-${{ github.workflow }}-${{ github.ref }}
  cancel-in-progress: true

jobs:
  basic:
    name: Build versatiles
    uses: ./.github/workflows/build-image.yml
    secrets: inherit
    with:
      name: versatiles

  frontend:
    needs: basic
    name: Build -frontend
    uses: ./.github/workflows/build-image.yml
    secrets: inherit
    with:
      name: versatiles-frontend

  nginx:
    needs: basic
    name: Build -nginx
    uses: ./.github/workflows/build-image.yml
    secrets: inherit
    with:
      name: versatiles-nginx

  tilemaker:
    needs: basic
    name: Build -tilemaker
    uses: ./.github/workflows/build-image.yml
    secrets: inherit
    with:
      name: versatiles-tilemaker

  tippecanoe:
    needs: basic
    name: Build -tippecanoe
    uses: ./.github/workflows/build-image.yml
    secrets: inherit
    with:
      name: versatiles-tippecanoe
